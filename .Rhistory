col = "violet",
pos = 4
)
legend(
"top",
legend,
cex = 0.6,
text.col = "violet"
)
dev.off()
plot_file <- "./pca.png"
png(plot_file)
plot(
x,
y,
main = "Analiza głównych składowych",
xlab = "PC1",
ylab = "PC2",
col = "purple",
pch = 16
)
text(
x,
y,
paste(
"d",
1:length(rownames(dtm_tfidf_bounds)),
sep = ""
),
col = "purple",
pos = 4
)
legend(
"top",
legend,
cex = 0.6,
text.col = "purple"
)
dev.off()
plot_file <- "./pca.png"
png(plot_file)
plot(
x,
y,
main = "Analiza głównych składowych",
xlab = "PC1",
ylab = "PC2",
col = "purple",
pch = 16
)
text(
x,
y,
paste(
"d",
1:length(rownames(dtm_tfidf_bounds)),
sep = ""
),
col = "purple",
pos = 1
)
legend(
"top",
legend,
cex = 0.6,
text.col = "purple"
)
dev.off()
png(plot_file)
plot(
x,
y,
main = "Analiza głównych składowych",
xlab = "PC1",
ylab = "PC2",
col = "purple",
pch = 16,
xlim = c(0,50),
ylim = c(-10,0)
)
text(
x,
y,
paste(
"d",
1:length(rownames(dtm_tfidf_bounds)),
sep = ""
),
col = "purple",
pos = 1
)
legend(
"top",
legend,
cex = 0.6,
text.col = "purple"
)
dev.off()
plot_file <- "./pca.png"
png(plot_file)
plot(
x,
y,
main = "Analiza głównych składowych",
xlab = "PC1",
ylab = "PC2",
col = "purple",
pch = 16,
xlim = c(0,50),
ylim = c(-10,0)
)
text(
x,
y,
paste(
"d",
1:length(rownames(dtm_tfidf_bounds)),
sep = ""
),
col = "purple",
pos = 1
)
legend(
"topleft",
legend,
cex = 0.6,
text.col = "purple"
)
dev.off()
plot_file <- "./pca.png"
png(plot_file)
plot(
x,
y,
#  xlim = c(0,50),
#  ylim = c(-10,0),
main = "Analiza głównych składowych",
xlab = "PC1",
ylab = "PC2",
col = "purple",
pch = 16
)
text(
x,
y,
paste(
"d",
1:length(rownames(dtm_tfidf_bounds)),
sep = ""
),
col = "purple",
pos = 1
)
legend(
"topleft",
legend,
cex = 0.6,
text.col = "purple"
)
dev.off()
png(plot_file)
plot(
x,
y,
#  xlim = c(0,50),
#  ylim = c(-10,0),
main = "Analiza głównych składowych",
xlab = "PC1",
ylab = "PC2",
col = "purple",
pch = 16
)
text(
x,
y,
paste(
"d",
1:length(rownames(dtm_tfidf_bounds)),
sep = ""
),
col = "purple",
pos = 1
)
legend(
"top",
legend,
cex = 0.6,
text.col = "purple"
)
dev.off()
install.packages("lsa")
# wczytanie bibliotek
library(lsa)
# analiza ukrytych wymiarów semantycznych
# dekompozycja wg wartości osobliwych
lsa_model <- lsa(tdm_tf_bounds_m)
View(lsa_model)
coord_docs <- lsa_model$dk%*%diag(lsa_model$sk)
coord_terms <- lsa_model$tk%*%diag(lsa_model$sk)
terms_importance <- diag(
lsa_model$tk%*%diag(lsa_model$sk)%*%t(diag(lsa_model$sk))%*%t(lsa_model$tk)
)
important_terms <- names(
tail(
sort(terms_importance),
30
)
)
x1 <- coord_docs[,1]
y1 <- coord_docs[,2]
x2 <- coord_terms[important_terms,1]
y2 <- coord_terms[important_terms,2]
plot_file <- "./lsa.png"
png(plot_file)
plot(
x1,
y1,
#  xlim = c(0,50),
#  ylim = c(-10,0),
main = "Analiza ukrytych wymiarów semantycznych",
xlab = "SD1",
ylab = "SD2",
col = "purple",
pch = 16
)
text(
x1,
y1,
paste(
"d",
1:length(rownames(dtm_tfidf_bounds)),
sep = ""
),
col = "purple",
pos = 1
)
legend(
"topleft",
legend,
cex = 0.6,
text.col = "purple"
)
dev.off()
plot_file <- "./lsa.png"
png(plot_file)
plot(
x1,
y1,
#  xlim = c(0,50),
#  ylim = c(-10,0),
main = "Analiza ukrytych wymiarów semantycznych",
xlab = "SD1",
ylab = "SD2",
col = "purple",
pch = 16
)
text(
x1,
y1,
paste(
"d",
1:length(rownames(dtm_tfidf_bounds)),
sep = ""
),
col = "purple",
pos = 1
)
points(
x2,
y2,
pch = 15,
col = "magenta"
)
text(
x2,
y2,
rownames(coord_terms[important_terms,]),
col = "magenta"
)
legend(
"topleft",
legend,
cex = 0.6,
text.col = "purple"
)
dev.off()
plot_file <- "./lsa.png"
png(plot_file)
plot(
x1,
y1,
xlim = c(-50,0),
ylim = c(-10,20),
main = "Analiza ukrytych wymiarów semantycznych",
xlab = "SD1",
ylab = "SD2",
col = "purple",
pch = 16
)
text(
x1,
y1,
paste(
"d",
1:length(rownames(dtm_tfidf_bounds)),
sep = ""
),
col = "purple",
pos = 1
)
points(
x2,
y2,
pch = 15,
col = "magenta"
)
text(
x2,
y2,
rownames(coord_terms[important_terms,]),
col = "magenta"
)
legend(
"topleft",
legend,
cex = 0.6,
text.col = "purple"
)
dev.off()
plot_file <- "./lsa.png"
png(plot_file)
plot(
x1,
y1,
#  xlim = c(-50,0),
#  ylim = c(-10,20),
main = "Analiza ukrytych wymiarów semantycznych",
xlab = "SD1",
ylab = "SD2",
col = "purple",
pch = 16
)
text(
x1,
y1,
paste(
"d",
1:length(rownames(dtm_tfidf_bounds)),
sep = ""
),
col = "purple",
pos = 1
)
points(
x2,
y2,
pch = 15,
col = "magenta"
)
text(
x2,
y2,
rownames(coord_terms[important_terms,]),
col = "magenta"
)
legend(
"topleft",
legend,
cex = 0.6,
text.col = "purple"
)
dev.off()
own_terms <- c("harry", "hermiona", "łucja", "edmund","bella","edward")
x2 <- coord_terms[own_terms,1]
own_terms <- c("harry", "hermiona", "edmund","bella", "edward")
own_terms <- c("harry", "hermiona", "Łucja", "edmund","bella", "edward")
#x2 <- coord_terms[important_terms,1]
#y2 <- coord_terms[important_terms,2]
x2 <- coord_terms[own_terms,1]
own_terms <- c("harry")
#x2 <- coord_terms[important_terms,1]
#y2 <- coord_terms[important_terms,2]
x2 <- coord_terms[own_terms,1]
own_terms <- c("harry", "hermiona")
#x2 <- coord_terms[important_terms,1]
#y2 <- coord_terms[important_terms,2]
x2 <- coord_terms[own_terms,1]
own_terms <- c("harry", "hermiona", "Łucja")
#x2 <- coord_terms[important_terms,1]
#y2 <- coord_terms[important_terms,2]
x2 <- coord_terms[own_terms,1]
own_terms <- c("harry", "hermiona", "zuzanna", "edmund","bella", "edward")
#x2 <- coord_terms[important_terms,1]
#y2 <- coord_terms[important_terms,2]
x2 <- coord_terms[own_terms,1]
own_terms <- c("harry", "hermiona", "piotr", "edmund","bella", "edward")
#x2 <- coord_terms[important_terms,1]
#y2 <- coord_terms[important_terms,2]
x2 <- coord_terms[own_terms,1]
own_terms <- c("harry", "hermiona", "bella", "edward")
#x2 <- coord_terms[important_terms,1]
#y2 <- coord_terms[important_terms,2]
x2 <- coord_terms[own_terms,1]
important_terms
own_terms <- c("harry", "hermiona", "łucja", "edmund","bella", "edward")
own_terms
own_terms %in% important_terms
own_terms <- c("bella", "edward")
#x2 <- coord_terms[important_terms,1]
#y2 <- coord_terms[important_terms,2]
x2 <- coord_terms[own_terms,1]
own_terms <- c("harry", "hermiona", "łucja", "edmund")
#x2 <- coord_terms[important_terms,1]
#y2 <- coord_terms[important_terms,2]
x2 <- coord_terms[own_terms,1]
own_terms <- c("harry", "hermiona", "łucja", "edmund")
#x2 <- coord_terms[important_terms,1]
#y2 <- coord_terms[important_terms,2]
x2 <- coord_terms[own_terms,1]
y2 <- coord_terms[own_terms,2]
plot_file <- "./lsa.png"
png(plot_file)
plot(
x1,
y1,
#  xlim = c(-50,0),
#  ylim = c(-10,20),
main = "Analiza ukrytych wymiarów semantycznych",
xlab = "SD1",
ylab = "SD2",
col = "purple",
pch = 16
)
text(
x1,
y1,
paste(
"d",
1:length(rownames(dtm_tfidf_bounds)),
sep = ""
),
col = "purple",
pos = 1
)
points(
x2,
y2,
pch = 15,
col = "magenta"
)
text(
x2,
y2,
rownames(coord_terms[important_terms,]),
col = "magenta"
)
legend(
"topleft",
legend,
cex = 0.6,
text.col = "purple"
)
dev.off()
own_terms <- c("harry", "hermiona", "łucja", "edmund")
current_terms <- own_terms
x1 <- coord_docs[,1]
y1 <- coord_docs[,2]
x2 <- coord_terms[current_terms,1]
y2 <- coord_terms[current_terms,2]
plot_file <- "./lsa.png"
png(plot_file)
plot(
x1,
y1,
#  xlim = c(-50,0),
#  ylim = c(-10,20),
main = "Analiza ukrytych wymiarów semantycznych",
xlab = "SD1",
ylab = "SD2",
col = "purple",
pch = 16
)
text(
x1,
y1,
paste(
"d",
1:length(rownames(dtm_tfidf_bounds)),
sep = ""
),
col = "purple",
pos = 1
)
points(
x2,
y2,
pch = 15,
col = "magenta"
)
text(
x2,
y2,
rownames(coord_terms[current_terms,]),
col = "magenta"
)
legend(
"topleft",
legend,
cex = 0.6,
text.col = "purple"
)
dev.off()
